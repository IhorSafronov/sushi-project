(()=>{"use strict";let t=!1;setTimeout((()=>{if(t){let t=new Event("windowScroll");window.addEventListener("scroll",(function(e){document.dispatchEvent(t)}))}}),0),fetch("files/single-product.json").then((t=>t.json())).then((t=>{if(!t||!t.products||!Array.isArray(t.products))throw new Error("Invalid data format");const e=document.querySelector("#product-card-template");function o(t){const o=e.content.cloneNode(!0),n=o.querySelector(".product-image"),c=o.querySelector(".product-name"),r=o.querySelector(".product-price"),a=o.querySelector(".product-weight"),l=o.querySelector(".product-id"),i=o.querySelector(".price-console"),s=o.querySelector(".product-id-two");return c.textContent=t.title,n.src=t.image,r.textContent=`${t.price}.00 ₴`,a.textContent=`Вес: ${t.weight} г`,l.textContent=t.id,s.textContent=t.id,i.textContent=t.price,o}const n={};t.products.forEach((t=>{n[t.category]||(n[t.category]=[]),n[t.category].push(t)}));for(const t in n){const e=document.querySelector(`.product-list[data-category="${t}"]`);e&&n[t].forEach((t=>{const n=o(t);e.appendChild(n)}))}})).catch((t=>console.error(t)));const e=new URLSearchParams(window.location.search).get("id");fetch("files/single-product.json").then((t=>t.json())).then((t=>{const o=t.products.find((t=>t.id===e));if(o){const t=document.querySelector(".product-image"),e=document.querySelector(".product-name"),n=document.querySelector(".product-title"),c=document.querySelector(".product-price"),r=document.querySelector(".product-weight"),a=document.querySelector(".product-quantity"),l=document.querySelector(".product-ingredients"),i=document.querySelector(".product-id"),s=document.querySelector(".price-console"),u=document.querySelector(".product-id-two");t.src=o.image,e.textContent=o.title,n.textContent=o.title,c.textContent=`${o.price}.00 ₴`,a.textContent=`Количество: ${o.quantity}`,r.textContent=`Вес: ${o.weight} г`,l.textContent="",i.textContent=o.id,u.textContent=o.id,s.textContent=o.price;const d=document.createElement("ul");l.appendChild(d);for(let t of o.ingredients){const e=document.createElement("li");e.innerText=t,d.appendChild(e)}console.log(o)}else console.log(`Продукт с идентификатором ${e} не найден`)})).catch((t=>console.error(t)));document.querySelectorAll(".product-list").forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest(".item-product__body");if(!e)return;const o=e.querySelector(".product-id").textContent;console.log(o);const n=`./product-page.html?id=${o}`;window.location.href=n}))}));let o=JSON.parse(localStorage.getItem("productIds"))||[],n=parseFloat(localStorage.getItem("total"))||0;document.querySelectorAll(".product-list").forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest(".action-body__cart");if(!e)return;const c=e.querySelector(".product-id-two").textContent,r=e.querySelector(".price-console").textContent;o.push(c),n+=parseFloat(r),console.log(o),console.log(n);document.querySelector("#cart-total").textContent=n.toFixed(2)+" ₴",localStorage.setItem("productIds",JSON.stringify(o)),localStorage.setItem("total",n)}))}));const c=document.querySelector(".action-body__cart");if(c&&c.addEventListener("click",(()=>{const t=document.querySelector(".product-id-two").textContent,e=document.querySelector(".price-console").textContent;o.push(t),console.log(`ID товара: ${t}, Price: ${e}`),console.log(o),n+=parseFloat(e),console.log(n);document.querySelector("#cart-total").textContent=n.toFixed(2)+" ₴",localStorage.setItem("productIds",JSON.stringify(o)),localStorage.setItem("total",n)})),function(){const t=document.querySelector("#cart-total");n=parseFloat(localStorage.getItem("total"))||0,t.textContent=n.toFixed(2)+" ₴"}(),"/cart-page.html"===window.location.pathname){const r=localStorage.getItem("productIds");function a(t){const e=document.querySelector(".product-names"),o=document.querySelectorAll(".total-price__summary");let n=0;e.innerHTML="",t.forEach((t=>{const o=document.createElement("div");o.classList.add("product-name"),o.textContent=t.name,e.appendChild(o),n+=t.price})),o.forEach((t=>{t.textContent=`${n}.00 ₴`}))}r&&(o=JSON.parse(r),fetch("files/single-product.json").then((t=>t.json())).then((t=>{const e=t.products.filter((t=>o.includes(t.id))),n=e.reduce(((t,e)=>t+e.price),0),c=e.map((t=>t.title)),r=e.map((t=>t.price)),a=document.querySelector(".product-names");if(a){const t=document.createElement("ul");t.classList.add("list-product");for(let e=0;e<c.length;e++){const o=document.createElement("li");o.classList.add("item-product-buy");const n=document.createElement("p");n.classList.add("title-product-buy"),n.textContent=c[e];const a=document.createElement("span");a.classList.add("price-product-buy"),a.textContent=`${r[e]}.00 ₴`,o.appendChild(n),o.appendChild(a),t.appendChild(o)}a.appendChild(t)}document.querySelectorAll(".total-price__summary").forEach((t=>{t.textContent=`${n}.00 ₴`}));const l=document.querySelector("#card-template");const i=document.querySelector(".cart-list");i&&e.forEach((t=>{const e=function(t){const e=l.content.cloneNode(!0),o=e.querySelector(".product-image"),n=e.querySelector(".product-name"),c=e.querySelector(".product-price"),r=e.querySelector(".product-weight"),a=e.querySelector(".product-quantity"),i=e.querySelector(".product-id"),s=e.querySelector(".id-delete-btn");return n.textContent=t.title,o.src=t.image,c.textContent=`${t.price}.00 ₴`,r.textContent=`Вес: ${t.weight} г.`,a.textContent=`Количество: ${t.quantity} шт.`,i.textContent=t.id,s.textContent=t.id,e}(t);i.appendChild(e)}))})).catch((t=>console.error(t))));document.querySelector(".cart-list").addEventListener("click",(t=>{if(t.target.classList.contains("remove-btn")){const e=t.target.closest(".cart-list__body").querySelector(".id-delete-btn").textContent,n=o.indexOf(e);if(n>-1){o.splice(n,1),localStorage.setItem("productIds",JSON.stringify(o));t.target.closest(".cart-list__body").remove(),a()}console.log(`Товар ${e} удален из корзины.`)}}));const l=document.querySelector(".order-page__form");l.addEventListener("submit",(function(t){t.preventDefault();const e=l.querySelector('input[name="name"]'),o=l.querySelector('input[name="phone"]'),n=l.querySelector('input[name="address"]'),c=l.querySelector('input[name="delivery"]:checked'),r=l.querySelector('input[name="payment"]:checked'),a=l.querySelector('textarea[name="info"]'),i=e?e.value:"",s=o?o.value:"",u=n?n.value:"",d=c?c.value:"",p=r?r.value:"",m=a?a.value:"",y=document.querySelectorAll(".list-product li"),g=[];for(let t of y){const e=t.querySelector(".title-product-buy").textContent,o=t.querySelector(".price-product-buy").textContent;g.push(`${e} \n ${o}`)}const S=g.map(((t,e)=>0===e?`\n\t${t}`:`\t${t}`)).join("\n");console.log(S);const q=document.querySelector(".total-price__summary").textContent,f={orderNumber:Math.floor(100*Math.random()),dateTime:(new Date).toLocaleString("uk-UA"),name:i,phone:s,address:u,info:m,delivery:d,payment:p,productsMessage:S,totalSum:q};console.log(f);fetch(`https://api.telegram.org/bot6051240657:AAFDbc5xa3gTJTcEMC0Gy4gKIzJfDXitQ4s/sendMessage?chat_id=-1001817694774&text=${encodeURIComponent(`Новый заказ:\n\n      📝: \t\t${f.orderNumber}\n      \t\t${f.dateTime}\n\n\n      👤: \t\t${f.name}\n      📞: \t\t${f.phone}\n      🏠: \t\t${f.address}\n      ℹ:  \t\t${f.info}\n\n\n      🚚: \t\t${f.delivery}\n      🧾: \t\t${f.payment}\n\n\n      \t\t${f.productsMessage}\n\n      💰: \t\t${f.totalSum}`)}`).then((t=>{if(!t.ok)throw new Error("Network response was not ok");console.log("Telegram message sent successfully")})).catch((t=>{console.error("Error sending Telegram message:",t)}))}))}window.FLS=!0,function(t){let e=new Image;e.onload=e.onerror=function(){t(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(t){let e=!0===t?"webp":"no-webp";document.documentElement.classList.add(e)})),document.addEventListener("click",(function(t){let e=t.target;if(e.closest("[data-quantity-plus]")||e.closest("[data-quantity-minus]")){const t=e.closest("[data-quantity]").querySelector("[data-quantity-value]");let o=parseInt(t.value);e.hasAttribute("data-quantity-plus")?(o++,+t.dataset.quantityMax&&+t.dataset.quantityMax<o&&(o=t.dataset.quantityMax)):(--o,+t.dataset.quantityMin?+t.dataset.quantityMin>o&&(o=t.dataset.quantityMin):o<1&&(o=1)),e.closest("[data-quantity]").querySelector("[data-quantity-value]").value=o}})),function(){const t=document.querySelectorAll(".rating");t.length>0&&function(){let e,o;for(let e=0;e<t.length;e++){n(t[e])}function n(t){c(t),r(),t.classList.contains("rating_set")&&a(t)}function c(t){e=t.querySelector(".rating__active"),o=t.querySelector(".rating__value")}function r(t=o.innerHTML){const n=t/.05;e.style.width=`${n}%`}function a(t){const e=t.querySelectorAll(".rating__item");for(let n=0;n<e.length;n++){const a=e[n];a.addEventListener("mouseenter",(function(e){c(t),r(a.value)})),a.addEventListener("mouseleave",(function(t){r()})),a.addEventListener("click",(function(e){c(t),t.dataset.ajax?l(a.value,t):(o.innerHTML=n+1,r())}))}}async function l(t,e){if(!e.classList.contains("rating_sending")){e.classList.add("rating_sending");let t=await fetch("rating.json",{method:"GET"});if(t.ok){const n=(await t.json()).newRating;o.innerHTML=n,r(),e.classList.remove("rating_sending")}else alert("Помилка"),e.classList.remove("rating_sending")}}}()}()})();